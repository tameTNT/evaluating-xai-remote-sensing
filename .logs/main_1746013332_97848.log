2025-04-30 12:42:12,918 | main_1746013332_97848(id=97848) |   DEBUG | log.py:49 | get_logger | New logger successfully initialised at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/.logs/main_1746013332_97848.log
2025-04-30 12:42:14,873 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:15 | <module> | Explanation default loading/output path set to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix.
2025-04-30 12:42:15,352 | main_1746013332_97848(id=97848) |    INFO | utils.py:47 | get_torch_device | Using mps as torch device.
2025-04-30 12:42:15,352 | main_1746013332_97848(id=97848) |   DEBUG | utils.py:54 | get_torch_device | Set number of threads to 1 as using a non-Linux machine.
2025-04-30 12:42:15,353 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:325 | <module> | Successfully got script arguments: Namespace(random_seed=42, checkpoints_path=PosixPath('checkpoints'), num_workers=4, batch_size=32, visualise=False, h5_output_name='demo_output', dataset_name='EuroSATRGB', normalisation_type='scaling', model_name='ResNet50', explainer_name='GradCAM', shap_max_evals=10000, shap_batch_size=0, shap_multi_processes=1, output_completeness_proportion=0.2, continuity_perturbation_degree=0.15, compactness_threshold=0.5, samples_per_class=32, deletion_method='shuffle', deletion_iterations=15, num_random_trials=5, similarity_intersection_proportion=0.1, min_samples_for_similarity=10).
2025-04-30 12:42:15,358 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:39 | get_data_and_model | Loading dataset and model...
2025-04-30 12:42:15,358 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:29 | get_model_type | Attempting to load ResNet50 model...
2025-04-30 12:42:15,358 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:62 | get_dataset_object | Attempting to load EuroSATRGB dataset...
2025-04-30 12:42:15,376 | main_1746013332_97848(id=97848) |   DEBUG | eurosat.py:70 | __init__ | Normalising EuroSATRGB(test) assuming mean and std of 0.5.
2025-04-30 12:42:15,376 | main_1746013332_97848(id=97848) |   DEBUG | core.py:339 | build_transforms | Using RSScalingTransform(channel_wise=False, clamp=True) for EuroSATRGB(test).
2025-04-30 12:42:15,376 | main_1746013332_97848(id=97848) |   DEBUG | core.py:343 | build_transforms | Using Normalize(mean=[0.5, 0.5, 0.5], std=[0.5, 0.5, 0.5], inplace=True) for EuroSATRGB(test).
2025-04-30 12:42:15,377 | main_1746013332_97848(id=97848) |   DEBUG | core.py:356 | build_transforms | Upsizing EuroSATRGB(test) images via Resize.
2025-04-30 12:42:15,377 | main_1746013332_97848(id=97848) |    INFO | core.py:364 | build_transforms | Built transforms for EuroSATRGB(test).
2025-04-30 12:42:15,419 | main_1746013332_97848(id=97848) |    INFO | __init__.py:66 | get_dataset_object | Dataset EuroSATRGB(test) loaded with 5400 samples.
2025-04-30 12:42:15,705 | main_1746013332_97848(id=97848) |   DEBUG | resnet.py:41 | __init__ | Model ResNet50 initialised without pretrained weights.
2025-04-30 12:42:15,705 | main_1746013332_97848(id=97848) |   DEBUG | resnet.py:60 | __init__ | Changing output linear layer from 1000 to 10 output channels.
2025-04-30 12:42:15,706 | main_1746013332_97848(id=97848) |    INFO | resnet.py:63 | __init__ | Model ResNet50 successfully initialised with 3 input channels and 10 output classes.
2025-04-30 12:42:15,840 | main_1746013332_97848(id=97848) |   DEBUG | core.py:62 | load_weights | Loaded weights from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/checkpoints/EuroSATRGB/ResNet50/full/zxyyp118_final_0.990.st successfully to ResNet50.
2025-04-30 12:42:15,989 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:42:16,011 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:42:16,208 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:42:16,359 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:42:16,576 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:210 | load_state | Loaded input (shape=torch.Size([32, 3, 224, 224])) matches the provided check input (shape=torch.Size([32, 3, 224, 224])) with diff=0.0.
2025-04-30 12:42:16,578 | main_1746013332_97848(id=97848) |    INFO | __init__.py:221 | load_state | Loaded GradCAM object state from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/b000/GradCAM/ResNet50.npz successfully with kwargs set to {}.
2025-04-30 12:42:16,578 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:42:16,581 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are ≈equal with diff=0.0.
2025-04-30 12:42:16,582 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:42:16,582 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:42:16,669 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:42:16,771 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:210 | load_state | Loaded input (shape=torch.Size([32, 3, 224, 224])) matches the provided check input (shape=torch.Size([32, 3, 224, 224])) with diff=0.0.
2025-04-30 12:42:16,773 | main_1746013332_97848(id=97848) |    INFO | __init__.py:221 | load_state | Loaded GradCAM object state from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/randomised/GradCAM/ResNet50.npz successfully with kwargs set to {}.
2025-04-30 12:42:16,775 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are ≈equal with diff=0.0.
2025-04-30 12:42:16,775 | main_1746013332_97848(id=97848) |    INFO | __init__.py:307 | get_sub_explainer | Existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness).
2025-04-30 12:42:17,087 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:42:17,088 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:42:17,099 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:42:17,260 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:42:17,262 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:42:17,320 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:42:24,910 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:42:27,132 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:42:34,585 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:42:44,216 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:42:53,671 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:43:03,379 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:43:14,083 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:43:17,054 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:17,405 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:43:18,505 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:43:19,362 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:20,398 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:43:24,236 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:43:25,096 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:25,138 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/perturbed/GradCAM.
2025-04-30 12:43:25,138 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:43:25,139 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:43:25,139 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:43:25,139 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:43:25,139 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:43:25,139 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:43:27,555 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:43:27,560 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:43:27,793 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  1  2  3  4  5  6  8  9 11 12 16 19 20 21 22 24 25 26 28 30 31] (n=22/32).
2025-04-30 12:43:28,096 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=22).
2025-04-30 12:43:28,096 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=22).
2025-04-30 12:43:28,108 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=22).
2025-04-30 12:43:28,263 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=22).
2025-04-30 12:43:28,264 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=22).
2025-04-30 12:43:28,317 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:28,318 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:43:28,436 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:43:37,033 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:43:37,034 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:43:37,256 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]->[5 2 6 6 7 5 2 6 6 6 6 8 2 6 8 6 5 9 6 8 8 6 8 8 5 5 6 8 6 6 6 9].
2025-04-30 12:43:37,257 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/adversarial/GradCAM.
2025-04-30 12:43:37,257 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:43:37,257 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:43:37,257 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:43:37,257 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:43:37,258 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:43:37,258 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:43:38,596 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c00/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:43:38,899 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:38,900 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:38,913 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:39,082 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:39,084 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:39,150 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:39,152 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:43:39,155 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:43:39,164 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:43:39,292 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:43:39,335 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/b000/GradCAM.
2025-04-30 12:43:39,335 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:43:39,336 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:43:39,336 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:43:39,337 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:43:39,337 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:43:39,337 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 1. Generating new ones.
2025-04-30 12:43:39,337 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:43:40,582 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:43:40,584 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:43:40,584 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:40,615 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/randomised/GradCAM.
2025-04-30 12:43:40,615 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:43:40,616 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:43:40,616 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:43:40,616 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:43:40,616 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:43:40,616 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:43:41,679 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:43:41,918 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:41,918 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:41,930 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:42,075 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:42,077 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:43:42,140 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:43:50,390 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:43:53,276 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:44:01,105 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:44:11,514 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:44:21,646 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:44:31,262 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:44:40,499 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:44:42,340 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:44:42,693 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:44:43,797 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:44:44,652 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:44:45,701 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:44:49,718 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:44:50,596 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:44:50,630 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/perturbed/GradCAM.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:44:50,631 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:44:51,870 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:44:51,871 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:44:52,124 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[14] (n=1/32).
2025-04-30 12:44:52,439 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=1).
2025-04-30 12:44:52,439 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=1).
2025-04-30 12:44:52,451 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=1).
2025-04-30 12:44:52,626 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=1).
2025-04-30 12:44:52,628 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=1).
2025-04-30 12:44:52,692 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:44:52,692 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:44:52,814 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:45:01,563 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:45:01,564 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:45:01,763 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]->[6 5 2 8 2 8 3 2 7 6 8 8 2 2 9 3 7 2 6 5 9 9 0 2 8 2 2 3 3 2 2 2].
2025-04-30 12:45:01,765 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/adversarial/GradCAM.
2025-04-30 12:45:01,765 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:45:01,765 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:45:01,765 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:45:01,766 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:45:01,766 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:45:01,766 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:45:03,053 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c01/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:45:03,366 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:03,366 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:03,378 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:03,546 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:03,547 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:03,602 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:45:03,604 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:45:03,611 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:45:03,619 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:45:03,749 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:45:03,775 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/b000/GradCAM.
2025-04-30 12:45:03,775 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:45:03,776 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:45:03,776 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:45:03,778 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:45:03,778 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:45:03,778 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 2. Generating new ones.
2025-04-30 12:45:03,778 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:45:05,038 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:45:05,040 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:45:05,040 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/randomised/GradCAM.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:45:05,065 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:45:06,914 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:45:07,194 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:07,194 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:07,211 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:07,373 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:07,375 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:45:07,429 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:45:15,677 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:45:18,397 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:45:26,672 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:45:37,373 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:45:47,946 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:45:58,337 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:46:08,999 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:46:11,843 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:12,207 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:46:13,365 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:46:14,234 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:15,333 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:46:19,358 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:46:20,228 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/perturbed/GradCAM.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:46:20,262 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:46:21,468 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:46:21,470 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:46:21,709 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  1  2  4  5  7  9 10 12 13 15 16 18 21 22 23 25 26 27 28 29 30 31] (n=23/32).
2025-04-30 12:46:22,011 | main_1746013332_97848(id=97848) | WARNING | batch_evaluate.py:466 | <module> | Model outputs changed on too many perturbed samples for class 2 meaning there are not enough samples for min_samples threshold (10). Skipping continuity evaluation for this class: using -inf values.
2025-04-30 12:46:22,011 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:22,012 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:46:22,133 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:46:28,988 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:46:28,989 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:46:29,153 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]->[4 7 1 6 1 1 6 6 9 9 1 4 5 1 6 6 5 1 0 7 8 9 1 5 6 1 6 5 9 5 7 5].
2025-04-30 12:46:29,154 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/adversarial/GradCAM.
2025-04-30 12:46:29,154 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:46:29,154 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:46:29,155 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:46:29,155 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:46:29,155 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:46:29,155 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:46:30,342 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c02/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:46:30,658 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:30,658 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:30,669 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:30,833 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:30,835 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:30,897 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:30,900 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:46:30,902 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:46:30,911 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:46:31,021 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:46:31,048 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/b000/GradCAM.
2025-04-30 12:46:31,048 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:46:31,048 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:46:31,048 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:46:31,050 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:46:31,050 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:46:31,050 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 3. Generating new ones.
2025-04-30 12:46:31,050 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:46:32,289 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:46:32,291 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:46:32,291 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:32,309 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/randomised/GradCAM.
2025-04-30 12:46:32,309 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:46:32,310 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:46:32,310 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:46:32,310 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:46:32,310 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:46:32,310 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:46:33,428 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:46:33,695 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:33,695 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:33,705 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:33,847 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:33,849 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:46:33,906 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:46:41,692 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:46:44,294 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:46:52,442 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:47:02,695 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:47:12,730 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:47:23,497 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:47:33,441 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:47:35,303 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:35,654 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:47:36,788 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:47:37,649 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:38,720 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:47:42,731 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:47:43,598 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:43,638 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/perturbed/GradCAM.
2025-04-30 12:47:43,638 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:47:43,638 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:47:43,639 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:47:43,639 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:47:43,639 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:47:43,639 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:47:44,843 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:47:44,845 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:47:45,080 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  3  5 10 14 16 17 19 22 24 26 28] (n=12/32).
2025-04-30 12:47:45,374 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=12).
2025-04-30 12:47:45,374 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=12).
2025-04-30 12:47:45,386 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=12).
2025-04-30 12:47:45,540 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=12).
2025-04-30 12:47:45,542 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=12).
2025-04-30 12:47:45,595 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:45,596 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:47:45,716 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:47:55,873 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:47:55,874 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:47:56,047 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]->[5 8 6 8 8 6 6 0 6 7 6 0 8 1 5 8 8 6 2 6 8 7 0 2 4 8 4 8 6 8 6 6].
2025-04-30 12:47:56,048 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/adversarial/GradCAM.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:47:56,049 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:47:57,249 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c03/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:47:57,555 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:47:57,555 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:47:57,566 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:47:57,721 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:47:57,723 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:47:57,773 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:57,777 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:47:57,781 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:47:57,796 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:47:57,943 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:47:57,966 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/b000/GradCAM.
2025-04-30 12:47:57,966 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:47:57,966 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:47:57,966 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:47:57,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:47:57,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:47:57,968 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 4. Generating new ones.
2025-04-30 12:47:57,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:47:59,148 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:47:59,149 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:47:59,149 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/randomised/GradCAM.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:47:59,173 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:48:00,265 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:48:00,536 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:48:00,536 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:48:00,547 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:48:00,687 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:48:00,689 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:48:00,744 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:48:08,844 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:48:11,566 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:48:19,994 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:48:31,029 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:48:41,283 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:48:51,177 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:49:01,389 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:49:03,231 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:03,583 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:49:04,706 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:49:05,567 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:06,614 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:49:10,527 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:49:11,390 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:11,430 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/perturbed/GradCAM.
2025-04-30 12:49:11,430 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:49:11,431 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:49:11,431 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:49:11,431 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:49:11,431 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:49:11,431 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:49:12,610 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:49:12,611 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:49:12,847 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 2  3  5  6  7  8  9 11 12 13 17 19 26 30] (n=14/32).
2025-04-30 12:49:13,150 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=14).
2025-04-30 12:49:13,151 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=14).
2025-04-30 12:49:13,161 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=14).
2025-04-30 12:49:13,319 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=14).
2025-04-30 12:49:13,321 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=14).
2025-04-30 12:49:13,378 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:13,378 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:49:13,497 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:49:23,565 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:49:23,565 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:49:23,760 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [7 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4]->[4 8 8 3 6 7 7 6 6 7 2 6 2 3 0 3 7 4 8 6 8 7 0 6 8 6 8 6 0 2 7 3].
2025-04-30 12:49:23,762 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/adversarial/GradCAM.
2025-04-30 12:49:23,762 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:49:23,763 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:49:23,763 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:49:23,763 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:49:23,763 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:49:23,763 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:49:24,974 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c04/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:49:25,287 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:25,287 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:25,298 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:25,466 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:25,467 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:25,530 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:25,533 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:49:25,537 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:49:25,553 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:49:25,708 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:49:25,734 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/b000/GradCAM.
2025-04-30 12:49:25,734 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:49:25,734 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:49:25,734 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:49:25,735 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:49:25,735 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:49:25,735 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 5. Generating new ones.
2025-04-30 12:49:25,735 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:49:26,984 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:49:26,990 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:49:26,990 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/randomised/GradCAM.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:49:27,013 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:49:28,099 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:49:28,344 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:28,344 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:28,355 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:28,492 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:28,493 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:49:28,558 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:49:36,907 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:49:39,657 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:49:47,263 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:49:56,636 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:50:05,815 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:50:14,979 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:50:24,185 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:50:25,998 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:26,350 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:50:27,464 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:50:28,317 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:29,361 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:50:33,344 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:50:34,215 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:34,251 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/perturbed/GradCAM.
2025-04-30 12:50:34,251 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:50:34,251 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:50:34,252 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:50:34,252 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:50:34,252 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:50:34,252 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:50:35,441 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:50:35,442 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:50:35,678 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31] (n=32/32).
2025-04-30 12:50:35,979 | main_1746013332_97848(id=97848) | WARNING | batch_evaluate.py:466 | <module> | Model outputs changed on too many perturbed samples for class 5 meaning there are not enough samples for min_samples threshold (10). Skipping continuity evaluation for this class: using -inf values.
2025-04-30 12:50:35,980 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:35,980 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:50:36,104 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:50:44,525 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:50:44,525 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:50:44,702 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [5 5 5 5 5 5 5 5 5 5 5 2 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5]->[2 6 0 8 6 2 0 1 8 1 0 5 2 3 3 0 2 6 6 9 0 0 3 1 4 2 0 6 8 0 8 6].
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/adversarial/GradCAM.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:50:44,704 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:50:45,929 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c05/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:50:46,231 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:46,231 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:46,242 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:46,395 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:46,396 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:46,448 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:46,451 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:50:46,454 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:50:46,460 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:50:46,566 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:50:46,590 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/b000/GradCAM.
2025-04-30 12:50:46,590 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:50:46,590 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:50:46,590 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:50:46,592 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:50:46,592 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:50:46,592 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 6. Generating new ones.
2025-04-30 12:50:46,592 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:50:47,802 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:50:47,804 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:50:47,804 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/randomised/GradCAM.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:50:47,829 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:50:48,939 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:50:49,222 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:49,222 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:49,232 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:49,375 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:49,376 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:50:49,425 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:50:57,052 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:50:58,827 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:51:06,518 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:51:16,640 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:51:25,921 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:51:35,414 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:51:44,824 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:51:47,555 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:51:47,920 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:51:49,046 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:51:49,932 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:51:50,990 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:51:55,004 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:51:55,877 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/perturbed/GradCAM.
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:51:55,913 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:51:55,914 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:51:57,101 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:51:57,103 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:51:57,340 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 5  7  8 12 16 24 29] (n=7/32).
2025-04-30 12:51:57,648 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=7).
2025-04-30 12:51:57,649 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=7).
2025-04-30 12:51:57,660 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=7).
2025-04-30 12:51:57,820 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=7).
2025-04-30 12:51:57,821 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=7).
2025-04-30 12:51:57,872 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:51:57,872 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:51:57,995 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:52:04,788 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:52:04,788 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:52:04,965 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 2 6 6 6 6 6 6 2 6 6 6 6 6 6 6]->[4 4 0 0 2 5 0 0 0 8 7 0 0 0 0 0 4 6 4 2 0 2 2 2 6 8 2 3 2 8 0 4].
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/adversarial/GradCAM.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:52:04,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:52:06,156 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c06/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:52:06,466 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:06,466 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:06,476 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:06,640 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:06,642 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:06,701 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:52:06,703 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:52:06,706 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:52:06,713 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:52:06,817 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:52:06,841 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/b000/GradCAM.
2025-04-30 12:52:06,841 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:52:06,842 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:52:06,842 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:52:06,843 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:52:06,843 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:52:06,843 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 7. Generating new ones.
2025-04-30 12:52:06,843 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:52:08,057 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:52:08,059 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:52:08,059 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:52:08,078 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/randomised/GradCAM.
2025-04-30 12:52:08,078 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:52:08,079 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:52:08,079 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:52:08,079 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:52:08,079 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:52:08,079 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:52:09,261 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:52:09,568 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:09,569 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:09,581 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:09,749 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:09,750 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:52:09,806 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:52:17,802 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:52:20,665 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:52:28,365 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:52:38,300 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:52:47,692 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:52:57,947 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:53:08,167 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:53:10,594 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:10,947 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:53:12,067 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:53:12,924 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:13,975 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:53:18,067 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:53:18,933 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:18,967 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/perturbed/GradCAM.
2025-04-30 12:53:18,967 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:53:18,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:53:18,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:53:18,968 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:53:18,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:53:18,968 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:53:20,158 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:53:20,159 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:53:20,398 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 7 11 17] (n=3/32).
2025-04-30 12:53:20,707 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=3).
2025-04-30 12:53:20,707 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=3).
2025-04-30 12:53:20,718 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=3).
2025-04-30 12:53:20,877 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=3).
2025-04-30 12:53:20,879 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=3).
2025-04-30 12:53:20,935 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:20,935 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:53:21,060 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:53:29,495 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:53:29,496 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:53:29,651 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7]->[0 6 8 4 2 2 2 4 2 3 2 2 2 3 6 6 4 2 2 8 2 8 4 2 3 1 6 6 8 2 3 4].
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/adversarial/GradCAM.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:53:29,654 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:53:30,843 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c07/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:53:31,146 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:31,146 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:31,157 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:31,318 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:31,320 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:31,378 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:31,380 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:53:31,384 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:53:31,391 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:53:31,496 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:53:31,518 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/b000/GradCAM.
2025-04-30 12:53:31,518 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:53:31,518 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:53:31,518 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:53:31,520 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:53:31,520 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:53:31,520 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 8. Generating new ones.
2025-04-30 12:53:31,520 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:53:32,725 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:53:32,726 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:53:32,726 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/randomised/GradCAM.
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:53:32,744 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:53:32,745 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:53:33,856 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:53:34,114 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:34,114 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:34,125 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:34,271 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:34,273 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:53:34,336 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:53:42,435 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:53:45,001 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:53:52,819 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:54:03,259 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:54:12,859 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:54:23,032 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:54:33,055 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:54:35,428 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:35,780 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:54:36,898 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:54:37,755 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:38,806 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:54:42,853 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:54:43,771 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:43,808 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/perturbed/GradCAM.
2025-04-30 12:54:43,808 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:54:43,809 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:54:43,809 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:54:43,809 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:54:43,809 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:54:43,809 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:54:45,021 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:54:45,026 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:54:45,273 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 19 20 21 22 23 24 25
 26 27 28 29 30 31] (n=30/32).
2025-04-30 12:54:45,586 | main_1746013332_97848(id=97848) | WARNING | batch_evaluate.py:466 | <module> | Model outputs changed on too many perturbed samples for class 8 meaning there are not enough samples for min_samples threshold (10). Skipping continuity evaluation for this class: using -inf values.
2025-04-30 12:54:45,586 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:45,586 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:54:45,707 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:54:54,282 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:54:54,283 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:54:54,458 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8]->[0 0 0 1 0 1 3 9 0 9 3 3 0 6 1 1 3 3 4 3 9 9 9 9 6 4 3 0 6 4 3 0].
2025-04-30 12:54:54,459 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/adversarial/GradCAM.
2025-04-30 12:54:54,459 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:54:54,460 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:54:54,460 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:54:54,460 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:54:54,460 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:54:54,460 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:54:55,667 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c08/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:54:55,970 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:55,970 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:55,981 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:56,137 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:56,138 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:56,193 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:56,196 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:54:56,200 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:54:56,208 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:54:56,311 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:288 | get_explainer_object | Building GradCAM explainer...
2025-04-30 12:54:56,334 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/b000/GradCAM.
2025-04-30 12:54:56,335 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/b000/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:54:56,335 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/b000/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/b000/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:54:56,335 | main_1746013332_97848(id=97848) |    INFO | __init__.py:302 | get_explainer_object | Explainer GradCAM loaded.
2025-04-30 12:54:56,336 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:54:56,336 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:54:56,336 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:95 | generate_explanations | No existing explanation for batch 0 of class 9. Generating new ones.
2025-04-30 12:54:56,336 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:54:57,620 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/b000/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:54:57,621 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:424 | <module> | Evaluating generated explanations...
2025-04-30 12:54:57,622 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via model_randomisation with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:54:57,638 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/randomised/GradCAM.
2025-04-30 12:54:57,638 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/randomised/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:54:57,639 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/randomised/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/randomised/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:54:57,639 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:54:57,639 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:54:57,639 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'randomised' (a sub-explainer for Correctness). Generating a new one.
2025-04-30 12:54:57,639 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:54:57,782 | main_1746013332_97848(id=97848) | WARNING | __init__.py:167 | explanation | GradCAM Explanation contains 4 all 0 explanations at idx=[ 8  9 22 29].
2025-04-30 12:54:58,773 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/randomised/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:54:59,004 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:59,004 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:59,015 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:59,151 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:59,153 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:54:59,207 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Correctness (via incremental_deletion with kwargs={'deletion_method': 'shuffle', 'iterations': 15, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:55:07,171 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:55:09,864 | main_1746013332_97848(id=97848) |   DEBUG | correctness.py:155 | _incremental_deletion | Performing incremental deletion for 5 rounds of randomised deletions.
2025-04-30 12:55:17,947 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:55:28,311 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:55:38,500 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:55:48,159 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:55:57,862 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Correctness with batch size 32 for model ResNet50.
2025-04-30 12:56:00,340 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via deletion_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:56:00,691 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:56:01,808 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:56:02,671 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating OutputCompleteness (via preservation_check with kwargs={'deletion_method': 'shuffle', 'proportion': 0.2, 'n_random_rankings': 5, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:56:03,723 | main_1746013332_97848(id=97848) |   DEBUG | output_completeness.py:153 | delete_from_input | Repeating for randomised deletions.
2025-04-30 12:56:07,628 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for OutputCompleteness with batch size 32 for model ResNet50.
2025-04-30 12:56:08,499 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Continuity (via perturbation with kwargs={'degree': 0.15, 'random_seed': 42}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:56:08,531 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/perturbed/GradCAM.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/perturbed/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/perturbed/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/perturbed/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'perturbed' (a sub-explainer for Continuity). Generating a new one.
2025-04-30 12:56:08,532 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:56:09,739 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/perturbed/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:56:09,740 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Continuity with batch size 32 for model ResNet50.
2025-04-30 12:56:09,979 | main_1746013332_97848(id=97848) |    INFO | continuity.py:95 | _perturbation | Perturbations changed the model's prediction for idxs=[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 22 23 24
 25 26 27 28 29 30] (n=30/32).
2025-04-30 12:56:10,285 | main_1746013332_97848(id=97848) | WARNING | batch_evaluate.py:466 | <module> | Model outputs changed on too many perturbed samples for class 9 meaning there are not enough samples for min_samples threshold (10). Skipping continuity evaluation for this class: using -inf values.
2025-04-30 12:56:10,285 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Contrastivity (via target_sensitivity with kwargs={}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:56:10,286 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:56:10,406 | main_1746013332_97848(id=97848) |    INFO | contrastivity.py:108 | _target_sensitivity | No existing adversarial images at /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/ResNet50_adversarial_examples.npz. Generating new ones via foolbox with batch size 32.
2025-04-30 12:56:20,880 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:169 | _target_sensitivity | Saved generated adversarial images to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/ResNet50_adversarial_examples.npz.
2025-04-30 12:56:20,880 | main_1746013332_97848(id=97848) |    INFO | __init__.py:259 | run_model | Generating model predictions on new images (e.g. perturbed) for Contrastivity with batch size 32 for model ResNet50.
2025-04-30 12:56:21,047 | main_1746013332_97848(id=97848) |   DEBUG | contrastivity.py:173 | _target_sensitivity | 32 adversarial examples (og->adv): [9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9]->[1 1 1 0 1 2 1 5 2 8 0 2 0 8 2 2 1 1 2 2 2 1 1 2 1 2 0 0 1 0 2 0].
2025-04-30 12:56:21,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:106 | npz_path | Created save_path of GradCAM: /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/adversarial/GradCAM.
2025-04-30 12:56:21,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:196 | load_state | Attempting to load explanation from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/adversarial/GradCAM/ResNet50.npz to GradCAM.
2025-04-30 12:56:21,049 | main_1746013332_97848(id=97848) |    INFO | __init__.py:87 | __init__ | Couldn't load existing explanations from /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/adversarial/GradCAM/ResNet50.npz and /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/adversarial/GradCAM/ResNet50.json. Using null values.
2025-04-30 12:56:21,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:26 | tolerant_equal | Shapes of a (torch.Size([])) and b (torch.Size([32, 3, 224, 224])) are not equal.
2025-04-30 12:56:21,049 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:131 | has_explanation_for | self.input and x are not ≈equal with diff=-1.
2025-04-30 12:56:21,050 | main_1746013332_97848(id=97848) |    INFO | __init__.py:300 | get_sub_explainer | No existing explanation found for provided samples (shape=torch.Size([32, 3, 224, 224])) in 'adversarial' (a sub-explainer for Contrastivity). Generating a new one.
2025-04-30 12:56:21,050 | main_1746013332_97848(id=97848) |    INFO | __init__.py:149 | explain | Generating explanations in GradCAM for x.shape=torch.Size([32, 3, 224, 224]) with kwargs={} (self.kwargs updated). General Explainer batch size (with gradients) is 32.
2025-04-30 12:56:22,403 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:187 | save_state | Saved GradCAM's explanation to /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/xai_output_unix/EuroSATRGB/c09/combined/adversarial/GradCAM/ResNet50.npz (kwargs={}).
2025-04-30 12:56:22,707 | main_1746013332_97848(id=97848) |    INFO | __init__.py:67 | __call__ | Generating similarity metrics for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:56:22,707 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:85 | l2_distance | Calculating L2 distance for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:56:22,718 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:129 | spearman_rank | Calculating Spearman rank for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:56:22,874 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:164 | top_m_intersection | Calculating Top-m intersection for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:56:22,876 | main_1746013332_97848(id=97848) |   DEBUG | __init__.py:185 | structural_similarity | Calculating structural similarity for Similarity(shape=(32, 224, 224), num_hidden_idxs=0).
2025-04-30 12:56:22,927 | main_1746013332_97848(id=97848) |    INFO | __init__.py:236 | evaluate | Evaluating Compactness (via threshold with kwargs={'threshold': 0.5}) of GradCAM for ResNet50 (with store_full_data=False).
2025-04-30 12:56:22,930 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:496 | <module> | Saving calculated evaluation metrics to results dataframe...
2025-04-30 12:56:22,933 | main_1746013332_97848(id=97848) |   DEBUG | batch_evaluate.py:67 | get_hdf5 | Opened HDF5 file /Users/lucah/Library/CloudStorage/OneDrive-DurhamUniversity/cs_project/results/GradCAM/demo_output.h5.
2025-04-30 12:56:22,940 | main_1746013332_97848(id=97848) |    INFO | batch_evaluate.py:518 | <module> | Script execution complete.
